<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>AVAudioEngine详解 &#183; PPSW.ASIA</title><meta name=title content="AVAudioEngine详解 &#183; PPSW.ASIA"><meta name=description content="AVAudioEngine 是 AVFoundation 框架中的核心类，用于构建音频处理图，即一系列音频单元的连接，可以实现复杂的音频处理任务。"><meta name=keywords content="AVAudio,"><link rel=canonical href=https://ppswdev.github.io/posts/ios/audioengine/><link type=text/css rel=stylesheet href=/css/main.bundle.min.5f8f4777872a0d3d0d40b3754a43f54f29ae82af8e7ee8b8cb972495c44f0d770b15cd4194b7a49bc85950ac492768c127b305a57fc92ed77bf7e230fb6530a4.css integrity="sha512-X49Hd4cqDT0NQLN1SkP1Tymugq+Ofui4y5cklcRPDXcLFc1BlLekm8hZUKxJJ2jBJ7MFpX/JLtd79+Iw+2UwpA=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.165327e9b2a9a8807ad5cb6c943a8f9a52756791c128e2dbfb3623bb42429636adb4bbb076b0447b592cad02914321a6aef0db10b907465de34fda41e2830281.js integrity="sha512-FlMn6bKpqIB61ctslDqPmlJ1Z5HBKOLb+zYju0JCljattLuwdrBEe1ksrQKRQyGmrvDbELkHRl3jT9pB4oMCgQ==" data-copy=Copy data-copied=Copied></script><script src=/lib/zoom/zoom.min.f592a181a15d2a5b042daa7f746c3721acf9063f8b6acd175d989129865a37d400ae0e85b640f9ad42cd98d1f8ad30931718cf8811abdcc5fcb264400d1a2b0c.js integrity="sha512-9ZKhgaFdKlsELap/dGw3Iaz5Bj+Las0XXZiRKYZaN9QArg6FtkD5rULNmNH4rTCTFxjPiBGr3MX8smRADRorDA=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://ppswdev.github.io/posts/ios/audioengine/"><meta property="og:site_name" content="PPSW.ASIA"><meta property="og:title" content="AVAudioEngine详解"><meta property="og:description" content="AVAudioEngine,iOS Euqalizer"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-17T21:00:01+08:00"><meta property="article:modified_time" content="2024-08-17T21:00:01+08:00"><meta property="article:tag" content="AVAudio"><meta property="og:image" content="https://ppswdev.github.io/posts/ios/audioengine/featured.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ppswdev.github.io/posts/ios/audioengine/featured.png"><meta name=twitter:title content="AVAudioEngine详解"><meta name=twitter:description content="AVAudioEngine,iOS Euqalizer"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"AVAudioEngine详解","headline":"AVAudioEngine详解","description":"AVAudioEngine,iOS Euqalizer","abstract":"AVAudioEngine 是 AVFoundation 框架中的核心类，用于构建音频处理图，即一系列音频单元的连接，可以实现复杂的音频处理任务。","inLanguage":"en","url":"https:\/\/ppswdev.github.io\/posts\/ios\/audioengine\/","author":{"@type":"Person","name":"Pin"},"copyrightYear":"2024","dateCreated":"2024-08-17T21:00:01\u002b08:00","datePublished":"2024-08-17T21:00:01\u002b08:00","dateModified":"2024-08-17T21:00:01\u002b08:00","keywords":["AVAudio"],"mainEntityOfPage":"true","wordCount":"1278"}]</script><meta name=author content="Pin"><link href=https://ppsw.asia/about/ rel=me><link href=https://github.com/ppswdev rel=me><link href=https://tiktok.com/@username rel=me><link href=https://youtube.com/username rel=me><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><meta name=theme-color><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js></script><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js></script><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js></script><script>const firebaseConfig={apiKey:"AIzaSyAFcfBphAIHxpsDsNzFeQySePj6VIIKQn0",authDomain:"AIzaSyAFcfBphAIHxpsDsNzFeQySePj6VIIKQn0",projectId:"ppsw-web",storageBucket:"ppsw-web.appspot.com",messagingSenderId:"216970810892",appId:"1:216970810892:web:6f8a07fa4558880e38c029",measurementId:"G-J9C596ELTY"};var app=firebase.initializeApp(firebaseConfig),db=firebase.firestore(),auth=firebase.auth()</script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 pl-[24px] pr-[24px]" style=z-index:100><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3"><div><a href=/ class=flex><span class=sr-only>PPSW.ASIA</span>
<img src=/img/logo.png width=108 height=108 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt=PPSW.ASIA></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">PPSW.ASIA</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Home</p></a><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Posts>Posts</p></a><a href=/portfolio/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Portfolio>Portfolio</p></a><a href=/lounge/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Lounge>Lounge</p></a><a href=/tags/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Tags>Tags</p></a><a href=/categories/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Categories>Categories</p></a><a href=/about/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=About>About</p></a><a href=https://github.com/ppswdev target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium" title></p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><label id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Home</p></a></li><li class=mt-1><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Posts>Posts</p></a></li><li class=mt-1><a href=/portfolio/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Portfolio>Portfolio</p></a></li><li class=mt-1><a href=/lounge/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Lounge>Lounge</p></a></li><li class=mt-1><a href=/tags/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Tags>Tags</p></a></li><li class=mt-1><a href=/categories/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Categories>Categories</p></a></li><li class=mt-1><a href=/about/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=About>About</p></a></li><li class=mt-1><a href=https://github.com/ppswdev target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></div><p class="text-bg font-bg" title></p></a></li></ul></div></label></div></div></div></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("menu-blur");n.style.opacity=t/300})</script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom" style=background-image:url(/posts/ios/audioengine/featured_hu_96c531242894f542.png)><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("background-blur");n.style.opacity=t/300})</script><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">AVAudioEngine详解</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2024-08-17T21:00:01+08:00>17 August 2024</time><span class="px-2 text-primary-500">&#183;</span><span>1278 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">6 mins</span></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h2 class="relative group">iOS 音频引擎 AVAudioEngine<div id=ios-音频引擎-avaudioengine class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#ios-%e9%9f%b3%e9%a2%91%e5%bc%95%e6%93%8e-avaudioengine aria-label=Anchor>#</a></span></h2><p><code>AVAudioEngine</code> 是 AVFoundation 框架中的核心类，用于构建音频处理图，即一系列音频单元的连接，可以实现复杂的音频处理任务。在 <code>AVAudioEngine</code> 中，你可以使用各种内置的音频单元 (<code>AVAudioUnit</code>) 来添加各种音频效果。以下是 <code>AVAudioEngine</code> 中可用的一些主要音频效果单元及其详细说明：</p><h3 class="relative group">1. AVAudioUnitTimePitch<div id=1-avaudiounittimepitch class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#1-avaudiounittimepitch aria-label=Anchor>#</a></span></h3><p><code>AVAudioUnitTimePitch</code> 是 AVFoundation 框架中的一个音频单元，用于在 <code>AVAudioEngine</code> 的音频处理图中实时改变音频的时间和音调。这个单元允许你独立地调整音频的速度和音高，这对于音乐制作、音频编辑和实时音频效果非常有用。</p><h5 class="relative group">主要功能<div id=主要功能 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e4%b8%bb%e8%a6%81%e5%8a%9f%e8%83%bd aria-label=Anchor>#</a></span></h5><ol><li><strong>时间拉伸</strong>: <code>AVAudioUnitTimePitch</code> 可以改变音频的播放速度，即时间拉伸，而不改变音高。这在需要调整音频长度以匹配特定时间线的情况下很有用。</li><li><strong>音调变化</strong>: 同时，这个单元也可以改变音频的音调（音高），而不改变播放速度。这在需要调整音频的音高以匹配其他音轨或音阶时非常有用。</li><li><strong>独立控制</strong>: 最重要的是，<code>AVAudioUnitTimePitch</code> 允许你独立控制时间拉伸和音调变化，这意味着你可以只改变音高而不改变速度，或者反之亦然。</li></ol><h5 class="relative group">属性<div id=属性 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e5%b1%9e%e6%80%a7 aria-label=Anchor>#</a></span></h5><p><code>AVAudioUnitTimePitch</code> 提供了几个关键属性来控制其行为：</p><ul><li><strong>pitch</strong>: 一个浮点数，表示音高的变化。1.0 表示原始音高，小于1.0表示降低音高，大于1.0表示提高音高。</li><li><strong>timePitchAlgorithm</strong>: 一个枚举值，表示所使用的时间拉伸和音调变化算法。可以是 <code>.varispeed</code>（仅改变播放速度）、<code>.advanced</code>（高级算法，提供独立的时间和音高控制）等。</li><li><strong>pitchCorrection</strong>: 一个整数值，表示音高的半音变化。0 表示无变化，正数表示升高音高，负数表示降低音高。</li><li><strong>rate</strong>: 一个浮点数，表示播放速度的变化。1.0 表示正常速度，小于1.0表示慢速播放，大于1.0表示快速播放。</li></ul><h5 class="relative group">使用示例<div id=使用示例 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e4%bd%bf%e7%94%a8%e7%a4%ba%e4%be%8b aria-label=Anchor>#</a></span></h5><p>下面是一个使用 <code>AVAudioUnitTimePitch</code> 的简单示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-swift data-lang=swift><span class=line><span class=cl><span class=kd>import</span> <span class=nc>AVFoundation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nv>audioEngine</span> <span class=p>=</span> <span class=n>AVAudioEngine</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nv>timePitchUnit</span> <span class=p>=</span> <span class=n>AVAudioUnitTimePitch</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 设置音调变化和播放速度</span>
</span></span><span class=line><span class=cl><span class=n>timePitchUnit</span><span class=p>.</span><span class=n>pitch</span> <span class=p>=</span> <span class=mf>1.5</span> <span class=c1>// 提升一个半音</span>
</span></span><span class=line><span class=cl><span class=n>timePitchUnit</span><span class=p>.</span><span class=n>rate</span> <span class=p>=</span> <span class=mf>1.0</span> <span class=c1>// 正常速度播放</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 将时间音调单元添加到音频引擎</span>
</span></span><span class=line><span class=cl><span class=n>audioEngine</span><span class=p>.</span><span class=n>attach</span><span class=p>(</span><span class=n>timePitchUnit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 连接输入和输出节点</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nv>inputNode</span> <span class=p>=</span> <span class=n>audioEngine</span><span class=p>.</span><span class=n>inputNode</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nv>outputNode</span> <span class=p>=</span> <span class=n>audioEngine</span><span class=p>.</span><span class=n>outputNode</span>
</span></span><span class=line><span class=cl><span class=n>audioEngine</span><span class=p>.</span><span class=n>connect</span><span class=p>(</span><span class=n>inputNode</span><span class=p>,</span> <span class=n>to</span><span class=p>:</span> <span class=n>timePitchUnit</span><span class=p>,</span> <span class=n>format</span><span class=p>:</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>audioEngine</span><span class=p>.</span><span class=n>connect</span><span class=p>(</span><span class=n>timePitchUnit</span><span class=p>,</span> <span class=n>to</span><span class=p>:</span> <span class=n>outputNode</span><span class=p>,</span> <span class=n>format</span><span class=p>:</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 准备并启动音频引擎</span>
</span></span><span class=line><span class=cl><span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=n>audioEngine</span><span class=p>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>catch</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=bp>print</span><span class=p>(</span><span class=s>&#34;Error starting audio engine: </span><span class=si>\(</span><span class=n>error</span><span class=si>)</span><span class=s>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 class="relative group">2. AVAudioUnitReverb（混响）<div id=2-avaudiounitreverb混响 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#2-avaudiounitreverb%e6%b7%b7%e5%93%8d aria-label=Anchor>#</a></span></h3><p>提供混响效果，可以模拟不同环境下的声音反射，用于营造空间感和深度感。</p><p>在音频处理领域，混响（Reverb）效果用于模拟声波在封闭空间中的反射，从而给声音添加深度和空间感。不同的混响算法和插件可以模拟各种环境，从小房间到大教堂，甚至是特殊的声学效果。在 <code>AVAudioUnitReverb</code> 类中，Apple 提供了几种预设的混响类型，但它们并不是所有可能的混响效果。下面列举的是 <code>AVAudioUnitReverb</code> 类中可用的几种预设混响类型：</p><ol><li><strong>SmallRoom</strong> - 模拟一个小房间的声学环境。</li><li><strong>MediumRoom</strong> - 模拟一个中等大小房间的声学环境。</li><li><strong>LargeRoom</strong> - 模拟一个大房间的声学环境。</li><li><strong>MediumHall</strong> - 模拟一个中等大小的音乐厅的声学环境。</li><li><strong>LargeHall</strong> - 模拟一个大音乐厅的声学环境。</li><li><strong>Plate</strong> - 模拟早期的金属板混响器（plate reverb）效果。</li><li><strong>MediumChamber</strong> - 模拟一个中等大小的录音室的声学环境。</li><li><strong>LargeChamber</strong> - 模拟一个大录音室的声学环境。</li><li><strong>Cathedral</strong> - 模拟大教堂的声学环境，通常有很长的尾音。</li><li><strong>Room</strong> - 一个通用的房间混响效果，可以进一步定制。</li><li><strong>Hall</strong> - 一个通用的大厅混响效果，可以进一步定制。</li><li><strong>Chamber</strong> - 一个通用的小室混响效果，可以进一步定制。</li><li><strong>LiveRoom</strong> - 模拟现场表演场地的声学环境。</li></ol><p>除了上述预设，<code>AVAudioUnitReverb</code> 还允许你自定义混响的参数，例如：</p><ul><li><strong>Wet/Dry Mix</strong> - 控制原始干声和混响湿声的混合比例。</li><li><strong>Decay Time</strong> - 控制混响尾音消失的时间长度。</li><li><strong>Diffusion</strong> - 控制声波的散射程度，影响混响的密度。</li><li><strong>Density</strong> - 控制早期反射的数量和分布。</li><li><strong>High Frequency Damping</strong> - 控制高频混响的衰减程度。</li><li><strong>Lowpass Filter</strong> - 控制混响信号的高频上限。</li></ul><p>除了 <code>AVAudioUnitReverb</code> 提供的预设，还有许多第三方插件和软件提供了更为专业和多样化的混响效果。这些插件通常在专业音频工作站（DAWs）中使用，如 Logic Pro、Pro Tools、Ableton Live 等，提供了更高级的控制和仿真效果，例如：</p><ul><li><strong>Convolution Reverb</strong> - 基于真实空间的声学响应（Impulse Response）来模拟混响。</li><li><strong>Modulated Reverb</strong> - 添加调制效果的混响，如颤音或镶边。</li><li><strong>Algorithmic Reverb</strong> - 使用数学算法而非真实空间的声学响应来模拟混响。</li><li><strong>Spring Reverb</strong> - 模拟早期弹簧混响器的效果。</li><li><strong>Ambience</strong> - 专注于模拟环境声音，如风声、雨声等。</li></ul><p>每种混响类型都有其独特的声学特性，选择哪种类型取决于你希望达到的特定声学效果。</p><p>参数：wetDryMix 是混响效果的湿干比参数。它表示原始信号（干信号）和混响信号（湿信号）的混合比例。值范围是 0 到 100，其中 0 表示完全干信号（无混响），100 表示完全湿信号（只有混响）。</p><h3 class="relative group">3. AVAudioUnitDistortion(失真效果)<div id=3-avaudiounitdistortion失真效果 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#3-avaudiounitdistortion%e5%a4%b1%e7%9c%9f%e6%95%88%e6%9e%9c aria-label=Anchor>#</a></span></h3><p>用于添加失真效果，可以产生摇滚音乐中常见的吉他放大器失真效果。</p><h3 class="relative group">4. AVAudioUnitEQ(均衡器)<div id=4-avaudiouniteq均衡器 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#4-avaudiouniteq%e5%9d%87%e8%a1%a1%e5%99%a8 aria-label=Anchor>#</a></span></h3><p>均衡器单元，允许你调整音频的频率响应，通过增加或减少特定频率的增益，可以调整音色和清晰度。</p><p>AVAudioUnitEQ 是一个强大的多频段均衡器类，提供了丰富的属性和方法来调整音频信号的频率响应。以下是 AVAudioUnitEQ 及其关键属性的详细说明：</p><p>AVAudioUnitEQ 是 AVAudioUnitEffect 的子类，用于实现多频段均衡器。它包含多个 AVAudioUnitEQFilterParameters 对象，每个对象代表一个频段。</p><h4 class="relative group">关键属性<div id=关键属性 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e5%85%b3%e9%94%ae%e5%b1%9e%e6%80%a7 aria-label=Anchor>#</a></span></h4><h5 class="relative group">bands<div id=bands class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#bands aria-label=Anchor>#</a></span></h5><ul><li><p>类型: [AVAudioUnitEQFilterParameters]</p></li><li><p>说明: 这是一个数组，包含均衡器的所有频段。每个频段由 AVAudioUnitEQFilterParameters 对象表示。</p></li><li><p>示例:</p></li></ul><p>let eq = AVAudioUnitEQ(numberOfBands: 10)</p><p>let bands = eq.bands</p><h5 class="relative group">globalGain<div id=globalgain class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#globalgain aria-label=Anchor>#</a></span></h5><ul><li><p>类型: Float</p></li><li><p>说明: 设置均衡器的全局增益，以分贝 (dB) 为单位。可以用来整体提升或降低音量。</p></li><li><p>示例: eq.globalGain = 1.0 // 增加全局增益1dB</p></li></ul><h4 class="relative group">AVAudioUnitEQFilterParameters<div id=avaudiouniteqfilterparameters class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#avaudiouniteqfilterparameters aria-label=Anchor>#</a></span></h4><p>AVAudioUnitEQFilterParameters 是 AVAudioUnitEQ 的一个子类，表示均衡器的单个频段。它包含以下关键属性：</p><h5 class="relative group">filterType<div id=filtertype class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#filtertype aria-label=Anchor>#</a></span></h5><ul><li><p>类型: AVAudioUnitEQFilterType</p></li><li><p>说明: 设置滤波器的类型。可选值包括 .parametric, .lowPass, .highPass, .resonantLowPass, .resonantHighPass, .bandPass, .bandStop, .lowShelf, .highShelf, .resonantLowShelf, .resonantHighShelf。</p></li><li><p>示例: band.filterType = .parametric</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-swift data-lang=swift><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=nc>AVAudioUnitEQFilterType</span> <span class=p>:</span><span class=nb>Int</span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=n>Parametric</span> <span class=err>参量均衡器</span> <span class=err>可以通过设置一些参量，来调节咱们均衡器的频点</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=n>LowPass</span> <span class=err>低通滤波器</span> <span class=err>衰弱高频</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=n>HighPass</span> <span class=err>高通滤波器</span> <span class=err>衰弱低频</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=n>ResonantLowPass</span>  <span class=err>可以引发共鸣的</span> <span class=err>低通滤波器</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=n>ResonantHighPass</span> <span class=err>可以引发共鸣的</span>  <span class=err>高通滤波器</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=n>BandPass</span> <span class=err>带通滤波器</span>  <span class=err>提升某一频率附近的信号</span> <span class=err>忽略过高</span> <span class=err>或</span> <span class=err>过低的</span> <span class=err>部分</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=n>BandStop</span> <span class=err>与上面的相反</span>  <span class=err>忽略某一频率附近的信号</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=n>LowShelf</span> <span class=err>低架</span> <span class=err>降低整体</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=n>HighShelf</span> <span class=err>高架</span> <span class=err>提升整体</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=n>ResonantLowShelf</span>  <span class=err>可以引发共鸣的</span> <span class=err>低架</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=n>ResonantHighShelf可以引发共鸣的</span> <span class=err>高架</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 class="relative group">frequency<div id=frequency class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#frequency aria-label=Anchor>#</a></span></h5><ul><li><p>类型: Float</p></li><li><p>说明: 设置滤波器的中心频率，以赫兹 (Hz) 为单位。</p></li><li><p>示例: band.frequency = 1000.0 // 设置中心频率为1000Hz</p></li></ul><h5 class="relative group">bandwidth<div id=bandwidth class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#bandwidth aria-label=Anchor>#</a></span></h5><ul><li><p>类型: Float</p></li><li><p>说明: 设置滤波器的带宽，以八度 (octaves) 为单位。仅适用于参数均衡器类型。</p></li><li><p>示例: band.bandwidth = 1.0 // 设置带宽为1个八度</p></li></ul><h5 class="relative group">gain<div id=gain class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#gain aria-label=Anchor>#</a></span></h5><ul><li><p>类型: Float</p></li><li><p>说明: 设置滤波器的增益，以分贝 (dB) 为单位。正值表示提升，负值表示衰减。</p></li><li><p>示例: band.gain = 5.0 // 增加增益5dB</p></li></ul><h4 class="relative group">bypass<div id=bypass class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#bypass aria-label=Anchor>#</a></span></h4><ul><li><p>类型: Bool</p></li><li><p>说明: 设置是否绕过此频段。true 表示绕过，false 表示启用。</p></li><li><p>示例: band.bypass = false // 启用此频段</p></li></ul><h4 class="relative group">示例代码<div id=示例代码 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e7%a4%ba%e4%be%8b%e4%bb%a3%e7%a0%81 aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-swift data-lang=swift><span class=line><span class=cl><span class=kd>import</span> <span class=nc>AVFoundation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 创建音频引擎</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nv>audioEngine</span> <span class=p>=</span> <span class=n>AVAudioEngine</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 创建均衡器，设置为10个频段</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nv>eq</span> <span class=p>=</span> <span class=n>AVAudioUnitEQ</span><span class=p>(</span><span class=n>numberOfBands</span><span class=p>:</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 配置每个频段</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=k>in</span> <span class=mf>0.</span><span class=p>.&lt;</span><span class=n>eq</span><span class=p>.</span><span class=n>bands</span><span class=p>.</span><span class=bp>count</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nv>band</span> <span class=p>=</span> <span class=n>eq</span><span class=p>.</span><span class=n>bands</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>band</span><span class=p>.</span><span class=n>filterType</span> <span class=p>=</span> <span class=p>.</span><span class=n>parametric</span>
</span></span><span class=line><span class=cl>    <span class=n>band</span><span class=p>.</span><span class=n>frequency</span> <span class=p>=</span> <span class=nb>Float</span><span class=p>(</span><span class=mi>32</span> <span class=o>*</span> <span class=n>pow</span><span class=p>(</span><span class=mf>2.0</span><span class=p>,</span> <span class=nb>Double</span><span class=p>(</span><span class=n>i</span><span class=p>)))</span> <span class=c1>// 设置频率</span>
</span></span><span class=line><span class=cl>    <span class=n>band</span><span class=p>.</span><span class=n>bandwidth</span> <span class=p>=</span> <span class=mf>0.5</span> <span class=c1>// 设置带宽</span>
</span></span><span class=line><span class=cl>    <span class=n>band</span><span class=p>.</span><span class=n>gain</span> <span class=p>=</span> <span class=mf>0.0</span> <span class=c1>// 设置增益</span>
</span></span><span class=line><span class=cl>    <span class=n>band</span><span class=p>.</span><span class=n>bypass</span> <span class=p>=</span> <span class=kc>false</span> <span class=c1>// 启用频段</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 设置全局增益</span>
</span></span><span class=line><span class=cl><span class=n>eq</span><span class=p>.</span><span class=n>globalGain</span> <span class=p>=</span> <span class=mf>1.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 将均衡器添加到音频引擎</span>
</span></span><span class=line><span class=cl><span class=n>audioEngine</span><span class=p>.</span><span class=n>attach</span><span class=p>(</span><span class=n>eq</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 连接均衡器到主混音器节点</span>
</span></span><span class=line><span class=cl><span class=n>audioEngine</span><span class=p>.</span><span class=n>connect</span><span class=p>(</span><span class=n>eq</span><span class=p>,</span> <span class=n>to</span><span class=p>:</span> <span class=n>audioEngine</span><span class=p>.</span><span class=n>mainMixerNode</span><span class=p>,</span> <span class=n>format</span><span class=p>:</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 启动音频引擎</span>
</span></span><span class=line><span class=cl><span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=n>audioEngine</span><span class=p>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>catch</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=bp>print</span><span class=p>(</span><span class=s>&#34;音频引擎启动失败: </span><span class=si>\(</span><span class=n>error</span><span class=si>)</span><span class=s>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 调整某个频段的增益</span>
</span></span><span class=line><span class=cl><span class=n>eq</span><span class=p>.</span><span class=n>bands</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>gain</span> <span class=p>=</span> <span class=mf>5.0</span> <span class=c1>// 增加第一个频段的增益</span>
</span></span></code></pre></div><h3 class="relative group">5. AVAudioUnitDelay<div id=5-avaudiounitdelay class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#5-avaudiounitdelay aria-label=Anchor>#</a></span></h3><p>延迟效果器，可以创建回声效果，常用于电子音乐制作和空间感增强。</p><h3 class="relative group">6. AVAudioUnitCompressor(压缩器)<div id=6-avaudiounitcompressor压缩器 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#6-avaudiounitcompressor%e5%8e%8b%e7%bc%a9%e5%99%a8 aria-label=Anchor>#</a></span></h3><p>压缩器，用于控制音频的动态范围，可以防止峰值过载，同时使较弱的声音更加清晰。</p><h3 class="relative group">7. AVAudioUnitFlanger<div id=7-avaudiounitflanger class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#7-avaudiounitflanger aria-label=Anchor>#</a></span></h3><p>镶边器，可以产生一种类似于旋转扬声器的效果，常用于创造特殊的声音质感。</p><h3 class="relative group">8. AVAudioUnitPhaser<div id=8-avaudiounitphaser class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#8-avaudiounitphaser aria-label=Anchor>#</a></span></h3><p>相位器，通过对音频信号的不同频率进行相位移，可以产生扫频效果。</p><h3 class="relative group">9. AVAudioUnitDistortionFactory(失真效果)<div id=9-avaudiounitdistortionfactory失真效果 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#9-avaudiounitdistortionfactory%e5%a4%b1%e7%9c%9f%e6%95%88%e6%9e%9c aria-label=Anchor>#</a></span></h3><p><code>AVAudioUnitDistortionFactory</code> 是 AVAudioEngine 中的一个类，它提供了一系列预设的失真效果单元。这些失真效果可以应用于音频信号，以产生不同的音色变化，尤其是在音乐制作中非常有用，例如在电吉他音轨上添加失真效果。</p><p>以下是在 <code>AVAudioUnitDistortionFactory</code> 中可获得的所有预设失真单元：</p><ol><li><strong>Overdrive</strong> - 这种失真类型通常模仿真空管放大器的自然过载特性，产生温暖而柔和的失真效果。</li><li><strong>Fuzz</strong> - Fuzz 失真通常会产生更加粗糙和饱和的音色，它会将输入信号的波峰削平，导致大量谐波的产生。</li><li><strong>Distortion</strong> - Distortion 类型的失真通常比 Overdrive 更加激进，它可以产生强烈的非线性失真效果，适合硬摇滚和重金属风格的音乐。</li><li><strong>Saturator</strong> - Saturator 效果模拟了磁带饱和或数字剪切的特性，可以产生更细腻的失真，通常用于轻微增强音色。</li><li><strong>Tube</strong> - 这个预设模拟了真空管设备的特性，产生温暖且富有音乐性的失真。</li><li><strong>Soft Clip</strong> - Soft clip 效果会平滑地限制信号的峰值，避免突然的音量尖峰，同时保留信号的基本音色。</li><li><strong>Hard Clip</strong> - Hard clip 则会更剧烈地剪切信号峰值，产生更明显的失真和削波效果。</li><li><strong>Foldback</strong> - Foldback 失真会在信号超过一定阈值时，将信号反向折叠，产生独特的音色变化。</li><li><strong>Wave Shaper</strong> - Wave shaper 允许对信号波形进行任意形状的变换，可以产生从轻微到极端的各种失真效果。</li><li><strong>Bit Crusher</strong> - Bit crusher 效果通过降低音频的比特深度来产生数字噪声和失真，通常用于创造电子音乐中的粗糙质感。</li><li><strong>Sample and Hold</strong> - Sample and Hold 效果会在随机或定期的时间间隔内“采样”信号的瞬时值，并保持该值直到下一次采样，产生断断续续的音色变化。</li></ol><h3 class="relative group">10. AVAudioUnitChorus<div id=10-avaudiounitchorus class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#10-avaudiounitchorus aria-label=Anchor>#</a></span></h3><p>合唱效果器，通过轻微延迟和调制信号的叠加，可以模仿多个演奏者的合奏效果。</p><h3 class="relative group">11. AVAudioUnitAudioUnit<div id=11-avaudiounitaudiounit class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#11-avaudiounitaudiounit aria-label=Anchor>#</a></span></h3><p>这个单元允许你加载外部的 Audio Unit 插件，极大地扩展了 <code>AVAudioEngine</code> 的功能，可以使用第三方音频效果和乐器。</p><h3 class="relative group">12. AVAudioUnitSampler<div id=12-avaudiounitsampler class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#12-avaudiounitsampler aria-label=Anchor>#</a></span></h3><p>采样器单元，用于加载和播放采样音频，可以用来构建自己的乐器。</p><h3 class="relative group">13. AVAudioUnitInstrument<div id=13-avaudiounitinstrument class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#13-avaudiounitinstrument aria-label=Anchor>#</a></span></h3><p>乐器单元，可以加载和播放 MIDI 信息，用于合成音乐。</p><h3 class="relative group">14. AVAudioUnitVarispeed(播放速度)<div id=14-avaudiounitvarispeed播放速度 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#14-avaudiounitvarispeed%e6%92%ad%e6%94%be%e9%80%9f%e5%ba%a6 aria-label=Anchor>#</a></span></h3><p>变速单元，可以改变音频的速度和播放时间，但不会改变音调。</p><h3 class="relative group">15. AVAudioUnitRecorder<div id=15-avaudiounitrecorder class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#15-avaudiounitrecorder aria-label=Anchor>#</a></span></h3><p>录音单元，用于录制音频流到文件，可以实现实时录音功能。</p><h3 class="relative group">16. AVAudioUnitTimeStretch<div id=16-avaudiounittimestretch class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#16-avaudiounittimestretch aria-label=Anchor>#</a></span></h3><p>时间拉伸单元，可以改变音频的播放时间而不改变音调，适用于节奏调整。</p><h3 class="relative group">17. AVAudioUnitMIDI<div id=17-avaudiounitmidi class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#17-avaudiounitmidi aria-label=Anchor>#</a></span></h3><p>MIDI 单元，用于处理 MIDI 信息，可以将 MIDI 控制信息转换为音频输出。</p><h3 class="relative group">18. AVAudioUnitSampler<div id=18-avaudiounitsampler class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#18-avaudiounitsampler aria-label=Anchor>#</a></span></h3><p>虽然已经提过一次，但是值得注意的是，<code>AVAudioUnitSampler</code> 可以作为复杂的乐器引擎使用，它支持多种触发模式和多种音色切换。</p><h3 class="relative group">19. AVAudioUnitGenerator<div id=19-avaudiounitgenerator class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#19-avaudiounitgenerator aria-label=Anchor>#</a></span></h3><p>音频生成单元，可以生成特定的音频波形，如正弦波、方波等。</p><h3 class="relative group">20. AVAudioUnitMixer<div id=20-avaudiounitmixer class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#20-avaudiounitmixer aria-label=Anchor>#</a></span></h3><p>混音器单元，用于混合多个音频流，可以调整各路音频的音量和平衡。</p><h3 class="relative group">21. AVAudioUnitEffect<div id=21-avaudiouniteffect class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#21-avaudiouniteffect aria-label=Anchor>#</a></span></h3><p>一个通用效果单元，可以作为其他效果单元的基类，但通常不会直接实例化。</p><h3 class="relative group">22. AVAudioUnitEQFilter<div id=22-avaudiouniteqfilter class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#22-avaudiouniteqfilter aria-label=Anchor>#</a></span></h3><p>虽然 <code>AVAudioUnitEQ</code> 提供了均衡器功能，但 <code>AVAudioUnitEQFilter</code> 提供了更细粒度的滤波器控制，可以单独设置每个频段的参数。</p><h3 class="relative group">使用示例<div id=使用示例-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e4%bd%bf%e7%94%a8%e7%a4%ba%e4%be%8b-1 aria-label=Anchor>#</a></span></h3><p>使用这些单元时，你需要将它们添加到 <code>AVAudioEngine</code> 中，并通过 <code>connect</code> 方法将它们连接起来形成一个处理链。例如，下面的代码展示了如何将均衡器和混响效果添加到音频引擎中：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-swift data-lang=swift><span class=line><span class=cl><span class=kd>let</span> <span class=nv>audioEngine</span> <span class=p>=</span> <span class=n>AVAudioEngine</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nv>eq</span> <span class=p>=</span> <span class=n>AVAudioUnitEQ</span><span class=p>(</span><span class=n>numberOfBands</span><span class=p>:</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nv>reverb</span> <span class=p>=</span> <span class=n>AVAudioUnitReverb</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 添加单元</span>
</span></span><span class=line><span class=cl><span class=n>audioEngine</span><span class=p>.</span><span class=n>attach</span><span class=p>(</span><span class=n>eq</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>audioEngine</span><span class=p>.</span><span class=n>attach</span><span class=p>(</span><span class=n>reverb</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 连接单元</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nv>inputNode</span> <span class=p>=</span> <span class=n>audioEngine</span><span class=p>.</span><span class=n>inputNode</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nv>outputNode</span> <span class=p>=</span> <span class=n>audioEngine</span><span class=p>.</span><span class=n>outputNode</span>
</span></span><span class=line><span class=cl><span class=n>audioEngine</span><span class=p>.</span><span class=n>connect</span><span class=p>(</span><span class=n>inputNode</span><span class=p>,</span> <span class=n>to</span><span class=p>:</span> <span class=n>eq</span><span class=p>,</span> <span class=n>format</span><span class=p>:</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>audioEngine</span><span class=p>.</span><span class=n>connect</span><span class=p>(</span><span class=n>eq</span><span class=p>,</span> <span class=n>to</span><span class=p>:</span> <span class=n>reverb</span><span class=p>,</span> <span class=n>format</span><span class=p>:</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>audioEngine</span><span class=p>.</span><span class=n>connect</span><span class=p>(</span><span class=n>reverb</span><span class=p>,</span> <span class=n>to</span><span class=p>:</span> <span class=n>outputNode</span><span class=p>,</span> <span class=n>format</span><span class=p>:</span> <span class=kc>nil</span><span class=p>)</span>
</span></span></code></pre></div><h3 class="relative group">注意事项<div id=注意事项 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9 aria-label=Anchor>#</a></span></h3><blockquote><p>在音频处理链中，效果的顺序会影响最终的音频输出。以下是一些常见的音频效果及其通常的排列顺序：</p><p><strong>动态处理（Dynamic Processing</strong>）: 包括压缩器（Compressor）、限制器（Limiter）等。这些效果通常放在最前面，以控制音频信号的动态范围。</p><p><strong>均衡器（Equalizer</strong>）: 用于调整音频信号的频率响应。通常在动态处理之后，以便在处理动态范围后进行频率调整。</p><p><strong>失真（Distortion）</strong>: 包括过载（Overdrive）、失真（Distortion）等。这些效果通常放在均衡器之后，以便在频率调整后添加失真效果。</p><p><strong>调制（Modulation）</strong>: 包括合唱（Chorus）、镶边（Flanger）、相位（Phaser）等。这些效果通常放在失真之后，以便在失真处理后添加调制效果。</p><p><strong>延迟（Delay）</strong>: 用于添加回声效果。通常放在调制效果之后，以便在调制处理后添加延迟效果。</p><p><strong>混响（Reverb）</strong>: 用于模拟空间效果。通常放在延迟之后，以便在延迟处理后添加混响效果。</p></blockquote><h2 class="relative group">获取频谱信息<div id=获取频谱信息 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e8%8e%b7%e5%8f%96%e9%a2%91%e8%b0%b1%e4%bf%a1%e6%81%af aria-label=Anchor>#</a></span></h2><h3 class="relative group">目标需求<div id=目标需求 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e7%9b%ae%e6%a0%87%e9%9c%80%e6%b1%82 aria-label=Anchor>#</a></span></h3><p>如何获取音频数据的频谱信息,根据音乐的律动，实现频谱可视化柱状图振幅效果？</p><h3 class="relative group">思路方案<div id=思路方案 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e6%80%9d%e8%b7%af%e6%96%b9%e6%a1%88 aria-label=Anchor>#</a></span></h3><p>要实现音频频谱可视化柱状图振幅效果，你需要从音频数据中提取频谱信息。可以使用 AVAudioEngine 和 AVAudioPCMBuffer 来获取音频数据，并使用快速傅里叶变换（FFT）来计算频谱。</p><p>以下是一个简化的示例，展示如何获取音频数据的频谱信息并实现频谱可视化柱状图振幅效果：</p><h4 class="relative group">获取音频数据并计算频谱<div id=获取音频数据并计算频谱 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e8%8e%b7%e5%8f%96%e9%9f%b3%e9%a2%91%e6%95%b0%e6%8d%ae%e5%b9%b6%e8%ae%a1%e7%ae%97%e9%a2%91%e8%b0%b1 aria-label=Anchor>#</a></span></h4><p>使用 AVAudioEngine 和 AVAudioPCMBuffer 获取音频数据。</p><p>使用 vDSP 库中的 FFT 函数计算频谱。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-swift data-lang=swift><span class=line><span class=cl><span class=kd>import</span> <span class=nc>AVFoundation</span>
</span></span><span class=line><span class=cl><span class=kd>import</span> <span class=nc>Accelerate</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>SpectrumAnalyzer</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>var</span> <span class=nv>fftSetup</span><span class=p>:</span> <span class=n>FFTSetup</span><span class=p>?</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>var</span> <span class=nv>log2n</span><span class=p>:</span> <span class=n>vDSP_Length</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nv>bufferSize</span><span class=p>:</span> <span class=nb>Int</span> <span class=c1>// 将访问级别更改为 internal</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>var</span> <span class=nv>window</span><span class=p>:</span> <span class=p>[</span><span class=nb>Float</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>var</span> <span class=nv>outputBuffer</span><span class=p>:</span> <span class=p>[</span><span class=nb>Float</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>var</span> <span class=nv>frequencyData</span><span class=p>:</span> <span class=p>[</span><span class=nb>Float</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>var</span> <span class=nv>downsampleFactor</span><span class=p>:</span> <span class=nb>Int</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>init</span><span class=p>(</span><span class=n>bufferSize</span><span class=p>:</span> <span class=nb>Int</span><span class=p>,</span> <span class=n>downsampleFactor</span><span class=p>:</span> <span class=nb>Int</span> <span class=p>=</span> <span class=mi>10</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 默认降采样因子为10</span>
</span></span><span class=line><span class=cl>        <span class=kc>self</span><span class=p>.</span><span class=n>bufferSize</span> <span class=p>=</span> <span class=n>bufferSize</span>
</span></span><span class=line><span class=cl>        <span class=kc>self</span><span class=p>.</span><span class=n>downsampleFactor</span> <span class=p>=</span> <span class=n>downsampleFactor</span>
</span></span><span class=line><span class=cl>        <span class=kc>self</span><span class=p>.</span><span class=n>log2n</span> <span class=p>=</span> <span class=n>vDSP_Length</span><span class=p>(</span><span class=n>log2</span><span class=p>(</span><span class=nb>Float</span><span class=p>(</span><span class=n>bufferSize</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=kc>self</span><span class=p>.</span><span class=n>fftSetup</span> <span class=p>=</span> <span class=n>vDSP_create_fftsetup</span><span class=p>(</span><span class=n>log2n</span><span class=p>,</span> <span class=nb>Int32</span><span class=p>(</span><span class=n>kFFTRadix2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=kc>self</span><span class=p>.</span><span class=n>window</span> <span class=p>=</span> <span class=p>[</span><span class=nb>Float</span><span class=p>](</span><span class=n>repeating</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=bp>count</span><span class=p>:</span> <span class=n>bufferSize</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>vDSP_hann_window</span><span class=p>(&amp;</span><span class=n>window</span><span class=p>,</span> <span class=n>vDSP_Length</span><span class=p>(</span><span class=n>bufferSize</span><span class=p>),</span> <span class=nb>Int32</span><span class=p>(</span><span class=n>vDSP_HANN_NORM</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=kc>self</span><span class=p>.</span><span class=n>outputBuffer</span> <span class=p>=</span> <span class=p>[</span><span class=nb>Float</span><span class=p>](</span><span class=n>repeating</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=bp>count</span><span class=p>:</span> <span class=n>bufferSize</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=kc>self</span><span class=p>.</span><span class=n>frequencyData</span> <span class=p>=</span> <span class=p>[</span><span class=nb>Float</span><span class=p>](</span><span class=n>repeating</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=bp>count</span><span class=p>:</span> <span class=n>bufferSize</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>deinit</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=kd>let</span> <span class=nv>fftSetup</span> <span class=p>=</span> <span class=n>fftSetup</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>vDSP_destroy_fftsetup</span><span class=p>(</span><span class=n>fftSetup</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>func</span> <span class=nf>analyze</span><span class=p>(</span><span class=n>buffer</span><span class=p>:</span> <span class=n>AVAudioPCMBuffer</span><span class=p>)</span> <span class=p>-&gt;</span> <span class=p>[</span><span class=nb>Float</span><span class=p>]</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>guard</span> <span class=kd>let</span> <span class=nv>fftSetup</span> <span class=p>=</span> <span class=n>fftSetup</span> <span class=k>else</span> <span class=p>{</span> <span class=k>return</span> <span class=p>[]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nv>frameCount</span> <span class=p>=</span> <span class=n>buffer</span><span class=p>.</span><span class=n>frameLength</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nv>realp</span> <span class=p>=</span> <span class=p>[</span><span class=nb>Float</span><span class=p>](</span><span class=n>repeating</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=bp>count</span><span class=p>:</span> <span class=nb>Int</span><span class=p>(</span><span class=n>frameCount</span> <span class=o>/</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nv>imagp</span> <span class=p>=</span> <span class=p>[</span><span class=nb>Float</span><span class=p>](</span><span class=n>repeating</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=bp>count</span><span class=p>:</span> <span class=nb>Int</span><span class=p>(</span><span class=n>frameCount</span> <span class=o>/</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nv>magnitudes</span> <span class=p>=</span> <span class=p>[</span><span class=nb>Float</span><span class=p>](</span><span class=n>repeating</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>,</span> <span class=bp>count</span><span class=p>:</span> <span class=nb>Int</span><span class=p>(</span><span class=n>frameCount</span> <span class=o>/</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>realp</span><span class=p>.</span><span class=n>withUnsafeMutableBufferPointer</span> <span class=p>{</span> <span class=n>realpPtr</span> <span class=k>in</span>
</span></span><span class=line><span class=cl>            <span class=n>imagp</span><span class=p>.</span><span class=n>withUnsafeMutableBufferPointer</span> <span class=p>{</span> <span class=n>imagpPtr</span> <span class=k>in</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nv>output</span> <span class=p>=</span> <span class=n>DSPSplitComplex</span><span class=p>(</span><span class=n>realp</span><span class=p>:</span> <span class=n>realpPtr</span><span class=p>.</span><span class=n>baseAddress</span><span class=p>!,</span> <span class=n>imagp</span><span class=p>:</span> <span class=n>imagpPtr</span><span class=p>.</span><span class=n>baseAddress</span><span class=p>!)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>buffer</span><span class=p>.</span><span class=n>floatChannelData</span><span class=p>?.</span><span class=n>pointee</span><span class=p>.</span><span class=n>withMemoryRebound</span><span class=p>(</span><span class=n>to</span><span class=p>:</span> <span class=n>DSPComplex</span><span class=p>.</span><span class=kc>self</span><span class=p>,</span> <span class=n>capacity</span><span class=p>:</span> <span class=nb>Int</span><span class=p>(</span><span class=n>frameCount</span><span class=p>))</span> <span class=p>{</span> <span class=p>(</span><span class=n>inputData</span><span class=p>)</span> <span class=k>in</span>
</span></span><span class=line><span class=cl>                    <span class=n>vDSP_ctoz</span><span class=p>(</span><span class=n>inputData</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=p>&amp;</span><span class=n>output</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>vDSP_Length</span><span class=p>(</span><span class=n>frameCount</span> <span class=o>/</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>vDSP_fft_zrip</span><span class=p>(</span><span class=n>fftSetup</span><span class=p>,</span> <span class=p>&amp;</span><span class=n>output</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>log2n</span><span class=p>,</span> <span class=n>FFTDirection</span><span class=p>(</span><span class=n>FFT_FORWARD</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>vDSP_zvmags</span><span class=p>(&amp;</span><span class=n>output</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=p>&amp;</span><span class=n>magnitudes</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>vDSP_Length</span><span class=p>(</span><span class=n>frameCount</span> <span class=o>/</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>downsample</span><span class=p>(</span><span class=n>magnitudes</span><span class=p>,</span> <span class=n>factor</span><span class=p>:</span> <span class=n>downsampleFactor</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>func</span> <span class=nf>downsample</span><span class=p>(</span><span class=kc>_</span> <span class=n>data</span><span class=p>:</span> <span class=p>[</span><span class=nb>Float</span><span class=p>],</span> <span class=n>factor</span><span class=p>:</span> <span class=nb>Int</span><span class=p>)</span> <span class=p>-&gt;</span> <span class=p>[</span><span class=nb>Float</span><span class=p>]</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>guard</span> <span class=n>factor</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=p>{</span> <span class=k>return</span> <span class=n>data</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nv>downsampledCount</span> <span class=p>=</span> <span class=n>data</span><span class=p>.</span><span class=bp>count</span> <span class=o>/</span> <span class=n>factor</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nv>downsampledData</span> <span class=p>=</span> <span class=p>[</span><span class=nb>Float</span><span class=p>](</span><span class=n>repeating</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>,</span> <span class=bp>count</span><span class=p>:</span> <span class=n>downsampledCount</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=k>in</span> <span class=mf>0.</span><span class=p>.&lt;</span><span class=n>downsampledCount</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kd>let</span> <span class=nv>start</span> <span class=p>=</span> <span class=n>i</span> <span class=o>*</span> <span class=n>factor</span>
</span></span><span class=line><span class=cl>            <span class=kd>let</span> <span class=nv>end</span> <span class=p>=</span> <span class=n>start</span> <span class=o>+</span> <span class=n>factor</span>
</span></span><span class=line><span class=cl>            <span class=kd>let</span> <span class=nv>sum</span> <span class=p>=</span> <span class=n>data</span><span class=p>[</span><span class=n>start</span><span class=p>..&lt;</span><span class=n>end</span><span class=p>].</span><span class=bp>reduce</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=o>+</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>downsampledData</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=p>=</span> <span class=n>sum</span> <span class=o>/</span> <span class=nb>Float</span><span class=p>(</span><span class=n>factor</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>downsampledData</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 class="relative group">绑定AVAudioEngine<div id=绑定avaudioengine class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e7%bb%91%e5%ae%9aavaudioengine aria-label=Anchor>#</a></span></h4><p>将频谱数据传递给 UI 层，更新柱状图的振幅。</p><p>以下是一个示例代码，展示如何实现这些步骤：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-swift data-lang=swift><span class=line><span class=cl><span class=kd>import</span> <span class=nc>AVFoundation</span>
</span></span><span class=line><span class=cl><span class=kd>import</span> <span class=nc>MediaPlayer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>AudioEnginePlayer</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=c1>//...</span>
</span></span><span class=line><span class=cl>   <span class=kd>var</span> <span class=nv>onSpectrumDataAvailable</span><span class=p>:</span> <span class=p>(([</span><span class=nb>Float</span><span class=p>])</span> <span class=p>-&gt;</span> <span class=nb>Void</span><span class=p>)?</span>
</span></span><span class=line><span class=cl>   <span class=c1>//...</span>
</span></span><span class=line><span class=cl>   <span class=kd>private</span> <span class=kd>var</span> <span class=nv>playerNode</span><span class=p>:</span> <span class=n>AVAudioPlayerNode</span>
</span></span><span class=line><span class=cl>   <span class=kd>private</span> <span class=kd>var</span> <span class=nv>spectrumAnalyzer</span><span class=p>:</span> <span class=n>SpectrumAnalyzer</span>
</span></span><span class=line><span class=cl>   <span class=c1>//...</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>   <span class=c1>/// 播放状态</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nv>isPlaying</span><span class=p>:</span> <span class=nb>Bool</span> <span class=p>=</span> <span class=kc>false</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>didSet</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>!</span><span class=n>isPlaying</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>// 如果没有播放，则所有频谱柱显示为 0 值</span>
</span></span><span class=line><span class=cl>                <span class=n>onSpectrumDataAvailable</span><span class=p>?([</span><span class=nb>Float</span><span class=p>](</span><span class=n>repeating</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>,</span> <span class=bp>count</span><span class=p>:</span> <span class=mi>24</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   <span class=kd>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=c1>//...</span>
</span></span><span class=line><span class=cl>        <span class=n>playerNode</span> <span class=p>=</span> <span class=n>AVAudioPlayerNode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=c1>//...</span>
</span></span><span class=line><span class=cl>        <span class=n>spectrumAnalyzer</span> <span class=p>=</span> <span class=n>SpectrumAnalyzer</span><span class=p>(</span><span class=n>bufferSize</span><span class=p>:</span> <span class=mi>1024</span><span class=p>,</span> <span class=n>downsampleFactor</span><span class=p>:</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>//...</span>
</span></span><span class=line><span class=cl>        <span class=n>setupAudioEngineTap</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>   <span class=c1>//...</span>
</span></span><span class=line><span class=cl>   <span class=kd>private</span> <span class=kd>func</span> <span class=nf>setupAudioEngineTap</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>audioEngine</span><span class=p>.</span><span class=n>mainMixerNode</span><span class=p>.</span><span class=n>installTap</span><span class=p>(</span><span class=n>onBus</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=n>bufferSize</span><span class=p>:</span> <span class=n>AVAudioFrameCount</span><span class=p>(</span><span class=n>spectrumAnalyzer</span><span class=p>.</span><span class=n>bufferSize</span><span class=p>),</span> <span class=n>format</span><span class=p>:</span> <span class=n>audioEngine</span><span class=p>.</span><span class=n>mainMixerNode</span><span class=p>.</span><span class=n>outputFormat</span><span class=p>(</span><span class=n>forBus</span><span class=p>:</span> <span class=mi>0</span><span class=p>))</span> <span class=p>{</span> <span class=p>[</span><span class=kr>weak</span> <span class=kc>self</span><span class=p>]</span> <span class=p>(</span><span class=n>buffer</span><span class=p>,</span> <span class=n>time</span><span class=p>)</span> <span class=k>in</span>
</span></span><span class=line><span class=cl>            <span class=k>guard</span> <span class=kd>let</span> <span class=nv>self</span> <span class=p>=</span> <span class=kc>self</span> <span class=k>else</span> <span class=p>{</span> <span class=k>return</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=kd>let</span> <span class=nv>magnitudes</span> <span class=p>=</span> <span class=kc>self</span><span class=p>.</span><span class=n>spectrumAnalyzer</span><span class=p>.</span><span class=n>analyze</span><span class=p>(</span><span class=n>buffer</span><span class=p>:</span> <span class=n>buffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>DispatchQueue</span><span class=p>.</span><span class=n>main</span><span class=p>.</span><span class=n>async</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=kc>self</span><span class=p>.</span><span class=n>isPlaying</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=c1>//print(&#34;\(magnitudes)\n\n\n&#34;)</span>
</span></span><span class=line><span class=cl>                    <span class=kc>self</span><span class=p>.</span><span class=n>onSpectrumDataAvailable</span><span class=p>?(</span><span class=n>magnitudes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=c1>//...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 class="relative group">创建频谱显示视图<div id=创建频谱显示视图 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e5%88%9b%e5%bb%ba%e9%a2%91%e8%b0%b1%e6%98%be%e7%a4%ba%e8%a7%86%e5%9b%be aria-label=Anchor>#</a></span></h4><p>创建一个 VisualizerView 类，用于绘制频谱柱状图。</p><p>在 updateUI 方法中调用 VisualizerView 的更新方法。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-swift data-lang=swift><span class=line><span class=cl><span class=kd>import</span> <span class=nc>UIKit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>VisualizerView</span><span class=p>:</span> <span class=n>UIView</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>var</span> <span class=nv>magnitudes</span><span class=p>:</span> <span class=p>[</span><span class=nb>Float</span><span class=p>]</span> <span class=p>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>override</span> <span class=kd>init</span><span class=p>(</span><span class=n>frame</span><span class=p>:</span> <span class=n>CGRect</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kc>super</span><span class=p>.</span><span class=kd>init</span><span class=p>(</span><span class=n>frame</span><span class=p>:</span> <span class=n>frame</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=kc>self</span><span class=p>.</span><span class=n>backgroundColor</span> <span class=p>=</span> <span class=p>.</span><span class=n>black</span> <span class=c1>// 设置背景颜色</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>required</span> <span class=kd>init</span><span class=p>?(</span><span class=n>coder</span><span class=p>:</span> <span class=n>NSCoder</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kc>super</span><span class=p>.</span><span class=kd>init</span><span class=p>(</span><span class=n>coder</span><span class=p>:</span> <span class=n>coder</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=kc>self</span><span class=p>.</span><span class=n>backgroundColor</span> <span class=p>=</span> <span class=p>.</span><span class=n>black</span> <span class=c1>// 设置背景颜色</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>func</span> <span class=nf>update</span><span class=p>(</span><span class=n>with</span> <span class=n>magnitudes</span><span class=p>:</span> <span class=p>[</span><span class=nb>Float</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kc>self</span><span class=p>.</span><span class=n>magnitudes</span> <span class=p>=</span> <span class=n>magnitudes</span>
</span></span><span class=line><span class=cl>        <span class=n>setNeedsDisplay</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>override</span> <span class=kd>func</span> <span class=nf>draw</span><span class=p>(</span><span class=kc>_</span> <span class=n>rect</span><span class=p>:</span> <span class=n>CGRect</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>guard</span> <span class=o>!</span><span class=n>magnitudes</span><span class=p>.</span><span class=bp>isEmpty</span> <span class=k>else</span> <span class=p>{</span> <span class=k>return</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nv>context</span> <span class=p>=</span> <span class=n>UIGraphicsGetCurrentContext</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>context</span><span class=p>?.</span><span class=n>clear</span><span class=p>(</span><span class=n>rect</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nv>barWidth</span> <span class=p>=</span> <span class=n>rect</span><span class=p>.</span><span class=n>width</span> <span class=o>/</span> <span class=n>CGFloat</span><span class=p>(</span><span class=n>magnitudes</span><span class=p>.</span><span class=bp>count</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=n>index</span><span class=p>,</span> <span class=n>magnitude</span><span class=p>)</span> <span class=k>in</span> <span class=n>magnitudes</span><span class=p>.</span><span class=n>enumerated</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kd>let</span> <span class=nv>barHeight</span> <span class=p>=</span> <span class=n>CGFloat</span><span class=p>(</span><span class=n>magnitude</span><span class=p>)</span> <span class=o>*</span> <span class=n>rect</span><span class=p>.</span><span class=n>height</span>
</span></span><span class=line><span class=cl>            <span class=kd>let</span> <span class=nv>barRect</span> <span class=p>=</span> <span class=n>CGRect</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=n>CGFloat</span><span class=p>(</span><span class=n>index</span><span class=p>)</span> <span class=o>*</span> <span class=n>barWidth</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>rect</span><span class=p>.</span><span class=n>height</span> <span class=o>-</span> <span class=n>barHeight</span><span class=p>,</span> <span class=n>width</span><span class=p>:</span> <span class=n>barWidth</span><span class=p>,</span> <span class=n>height</span><span class=p>:</span> <span class=n>barHeight</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>context</span><span class=p>?.</span><span class=n>setFillColor</span><span class=p>(</span><span class=n>UIColor</span><span class=p>.</span><span class=n>green</span><span class=p>.</span><span class=n>cgColor</span><span class=p>)</span> <span class=c1>// 设置填充颜色</span>
</span></span><span class=line><span class=cl>            <span class=n>context</span><span class=p>?.</span><span class=n>fill</span><span class=p>(</span><span class=n>barRect</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 添加调试日志</span>
</span></span><span class=line><span class=cl>        <span class=c1>//print(&#34;Drawing \(magnitudes.count) bars&#34;)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 class="relative group">将频谱数据添加到界面<div id=将频谱数据添加到界面 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line:none !important" href=#%e5%b0%86%e9%a2%91%e8%b0%b1%e6%95%b0%e6%8d%ae%e6%b7%bb%e5%8a%a0%e5%88%b0%e7%95%8c%e9%9d%a2 aria-label=Anchor>#</a></span></h4><p>在视图控制器中添加 VisualizerView 并将频谱数据传递给它</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-swift data-lang=swift><span class=line><span class=cl><span class=kd>import</span> <span class=nc>UIKit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>ViewController</span><span class=p>:</span> <span class=n>UIViewController</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>var</span> <span class=nv>visualizerView</span><span class=p>:</span> <span class=n>VisualizerView</span><span class=p>!</span>
</span></span><span class=line><span class=cl>    <span class=kr>lazy</span> <span class=kd>var</span> <span class=nv>audioEnginePlayer</span> <span class=p>=</span> <span class=n>AudioEnginePlayer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>override</span> <span class=kd>func</span> <span class=nf>viewDidLoad</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kc>super</span><span class=p>.</span><span class=n>viewDidLoad</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>visualizerView</span> <span class=p>=</span> <span class=n>VisualizerView</span><span class=p>(</span><span class=n>frame</span><span class=p>:</span> <span class=n>CGRectMake</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>view</span><span class=p>.</span><span class=n>bounds</span><span class=p>.</span><span class=n>width</span><span class=p>,</span> <span class=mi>300</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>view</span><span class=p>.</span><span class=n>addSubview</span><span class=p>(</span><span class=n>visualizerView</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>view</span><span class=p>.</span><span class=n>sendSubviewToBack</span><span class=p>(</span><span class=n>visualizerView</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>audioEnginePlayer</span><span class=p>.</span><span class=n>onSpectrumDataAvailable</span> <span class=p>=</span> <span class=p>{</span> <span class=p>[</span><span class=kr>weak</span> <span class=kc>self</span><span class=p>]</span> <span class=n>magnitudes</span> <span class=k>in</span>
</span></span><span class=line><span class=cl>            <span class=c1>//print(magnitudes)</span>
</span></span><span class=line><span class=cl>            <span class=kc>self</span><span class=p>?.</span><span class=n>visualizerView</span><span class=p>.</span><span class=n>update</span><span class=p>(</span><span class=n>with</span><span class=p>:</span> <span class=n>magnitudes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><strong class="block mt-8"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:youremail@example.com?subject=Reply%20to%20AVAudioEngine%e8%af%a6%e8%a7%a3">Reply by Email</a></strong></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt=Pin src=/img/author_hu_ff8f43e8fc4971.jpeg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Pin</div><div class="text-sm text-neutral-700 dark:text-neutral-400">A little bit about you</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:xiaopn166@gmail.com target=_blank aria-label=Email rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://ppsw.asia/about/ target=_blank aria-label=Link rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1c55.6-55.59 148-55.59 203.6.0 50 50 57.4 129.7 16.3 187.2L391.3 319.9C381 334.2 361 337.6 346.7 327.3c-14.4-10.3-17.8-30.3-7.5-44.6L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2c-31.4-31.4-82.5-31.4-114 0L105.5 289.5c-31.51 30.6-31.51 82.5.0 114C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4 265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2c-58.4 41.1-136.3 34.5-186.29-15.4-56.469-56.5-56.469-148.1.0-204.5L172.5 131.1zM467.5 380c-56.5 56.5-148 56.5-204.5.0-50-50-56.5-128.8-15.4-186.3L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7 307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8c31.4 31.4 82.5 31.4 114 0L534.5 222.5c31.5-31.5 31.5-83.4.0-114C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58 374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24c56.5 56.46 56.5 148.06.0 204.46L467.5 380z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/ppswdev target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://tiktok.com/@username target=_blank aria-label=Tiktok rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M448 209.91a210.06 210.06.0 01-122.77-39.25V349.38A162.55 162.55.0 11185 188.31V278.2a74.62 74.62.0 1052.23 71.18V0h88a121.18 121.18.0 001.86 22.17h0A122.18 122.18.0 00381 102.39a121.43 121.43.0 0067 20.14z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://youtube.com/username target=_blank aria-label=Youtube rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span></a></div></div></div></div><div class=mb-10></div></div><script>var oid="views_posts/ios/audioengine/index.md",oid_likes="likes_posts/ios/audioengine/index.md"</script><script type=text/javascript src=/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q+oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/posts/ios/cocoapods/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">万能解决方案之彻底解决cocoapods环境问题</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2024-07-21T09:09:07+08:00>21 July 2024</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/posts/flutter/001/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">F001-Flutter必备基础和环境安装</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-03-10T09:09:07+08:00>10 March 2025</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/agreements/privacy/ title="Privacy Policy">Privacy Policy</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/agreements/termsofuse/ title="Terms of use">Terms of Use</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">Copyright © 2025 PPSW.ASIA</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://ppswdev.github.io/ style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>